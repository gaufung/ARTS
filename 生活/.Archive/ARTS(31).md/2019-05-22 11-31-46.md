---
date: 2019-05-19
status: public
tags: ARTS
title: ARTS(31)
---

# 1 Algorithm

> 给定一个 `IPv4` 地址的字符串，将其转换为 `int` 表示的整数，需要考虑不合法的字符串，只能使用常数空间。比如字符串 `127.0.0.1` 表示一个 `IPv4`地址，每一段都是 `byte` 表示的整数，四个 `byte` 可以表示 32 位的整数 `2130706433`。

首先对字符串按字符 `.` 划分为四个部分，在将其转换为整数，然后依次左移 `24`, `16`, `8` 和 `0` 位，将这些左移后的结果按照**或**(`|`)操作完整整数转换。那么不合法的情况有哪些呢？

- 合法的 `IPv4` 地址每一段的范围只能是 $[0, 255]$；
- 按照 `.` 划分只能划分为四个部分；
- 字符串只能包含数字和 `.` 两种字符；
- `.` 不能连续两次出现，也不能出现在字符串首和尾。

```go
func IPv4ToInt(s string) (int, error) {
    i := 0
    dotCount := 0
    res := 0
    val : = 0
    for i < len(s) {
        if s[i] == '.'{
            if i==0 || (i>0 && s[i] == s[i-1]) || i == len(s)-1 {
                return 0, errors.New("invalid IPv4")
            }
            if dotCount >= 3 {
                 return 0, errors.New("invalid IPv4")
            }
            val = val << uint(8 * (3 - dotCount))
            res = res | val
            val = 0
            dotCount ++ 
        }else{
            if !(s[i] >= '0' &&s[i] <= '9') {
                return 0, errors.New("invalid IPv4")
            }
            val = val * 10 + int(s[i] - '0')
            if val > 255 {
                return 0, errors.New("invalid IPv4")
            }
        }
        i++
    }
     if val > 255 || dotCount > 3 {
        return 0, errors.New("invalid IPv4")
    }
    res = res | val
    return res, nil
}
```

# 2 Review

[Technical Debt](https://martinfowler.com/bliki/TechnicalDebt.html)

**技术债**

软件系统往往会构建在错误的设计上，内部质量的缺乏导致为系统修改和增加新的功能变得更加困难。技术债就是这种比喻，是由 `Ward Cunningham`提出来的，它用来形容我们如何处理这种错误的设计，就跟财务债务一样。我们为系统增加新功能而做的额外的工作就是为这些技术债付利息。



# 3 Tips

Linux 文本处理

## 3.1 find 

查找 txt 和 pdf 文件：`find . \(-name "*.txt" -name "*.pdf" \) -print`

正则查找： `find . -regex ".*\(\.txt|\.pdf\)$`

否定参数，查找非 txt 文件： `find . ! -name "*.txt" -print`


# 4 Share