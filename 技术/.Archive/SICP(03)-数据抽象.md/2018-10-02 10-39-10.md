---
title: SICP(03)-数据抽象
status: public
date: 2018-09-27
---
# 1 数据封装

## 1.1 封装
数据抽象的基本层次是将关联的数据组合在一起，比如有理数分为分子(`numerator`)和分母(`denominator`)，单个的分子和分母是没有意义的，因此需要一个构造器(`constructor`）:
```scheme
(define (make-rational (n d)
    (cons (n d)))
```
## 1.2 访问
但是在算术计算中，还是需要确定有理数的分子和分母，对于已经封装的对象，需要提供选择器(`selector`)来访问被封装的数据。
```scheme
(define (numerator r)
    (car r))
(define (denominator r)
    (cdr r))
```
## 1.3 接口
既然做到了数据的封装，就需要对封装的对象提供对外操作的接口，在接口中屏蔽操作的细节。对于有理数，最重要的就是算术运算，因此需要定义`add-rational`,`sub-rational`,`mul-rational`和`div-rational`运算
```scheme
(define (add-rational r1 r2)
    (make-rational (+ (* (numerator r1) (denominator r2))
                                 (* (numerator r1)(denominator r2)))
                             (* (denominator r1)(denominator r2))))
 (define (sub-rational r1 r2)
    (make-rational (- (* (numerator r1) (denominator r2))
                                 (* (numerator r1)(denominator r2)))
                             (* (denominator r1)(denominator r2))))
 (define (mul-rational r1 r2)
    (make ( (* (numerator r1) (numererator r2))
                (* (denomintor r1)(denomintor r2)))
(define (div-rational r1 r2)
    (make ( (* (numerator r1)(denominator r2)))
                (* (denominator r1)(numerator r1))))
```
通过数据抽象构造出如下的分层结构：

![](./_image/2018-10-02-10-30-15.jpg)
# 2 数据多种抽象
## 2.1 表示
有时候同一种对象有多种表示形式抽象表示，比如复数可以采用 $z=x + yi$ （`rectangular representation`） 或者 $z=re^{iA}$ (`polar representation`)，两种都有各自的优势，在计算复数的加法减法时第一种表示方式比较方便，而在计算乘法除法的时候，第二种方法比较方便。

![](./_image/2018-10-02-10-33-13.jpg)
## 2.2 公共接口
尽管有不同表示方式，但是每一种的实现都要实现如下的选择器`selector`：`real-part`，`imag-part`，``



